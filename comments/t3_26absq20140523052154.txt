You will never "earn" the respect of someone who treats you like you don't deserve any.

It's really strange that after four years you don't know his friends at all despite hanging out with them regularly. I don't really know enough to make any further comments, but something is off there.

It's possible that he just gets insecure around your friends since he doesn't know them well. Maybe he just wanted to seem cool to his friends or he thought it was just a dumb joke. I really don't know, but that is still a bit strange.