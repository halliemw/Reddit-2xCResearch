From the story there's two distinct possibilities:

1.  The dude is crazy.  He either was deathly afraid of finally having a legitimate, physical relationship with someone or is a sadist in that he strung her along knowing that he'd turn her down in person.  There's a very low probability of this.

2.  He was not attracted to her in person.  Ever see someone who has a bunch of pretty photos up on Facebook but is less attractive in person?  Pictures can be very deceptive, and if he had a far different view of her from her pictures I can definitely understand how hurt he could feel.  This is the much more likely possibility.

In rebuttal of the comment about they way he treated her being repulsive, how would you have reacted in that situation?  Although the best choice, it would be extremely hard to say "Actually... I thought you were more attractive, sorry." when she steps in the door.  It would be far, far worse to try to make the relationship work without any physical attraction.  From what I gathered, he tried to let her down as easily as possible, which is what 90% of us would do if it needed to be done.

To OP: different strokes for different folks.  He may not have found you attractive but I can guarantee that there's plenty of others that do.  It's great that you took up hitting the gym!  That's the best thing that you can do - use this experience as motivation.  And hey, he fell in love with your personality, didn't he?  You're lucky, a body is very easy to shape while a personality is not.  Keep hitting the gym, and never stop improving yourself.