This is rape.  Even if he did mistake you for Kristen, it would have been rape...just...him raping Kristen.  Please tell people.  Tell people until they listen.  Don't stop telling people.  What happened to you was not your fault, and it was very wrong.  You need support, and my advice would be not to get it from Kristen or Sean as they are too involved/invested in the situation.

I read your later comments in this thread and I want you to know that there are people out there who hear your voice and concerns loud and clear (unlike your jerkface friend who blamed you).  Victim blaming is disgusting, and should never be done.  Please find someone who validates your feelings and can offer you some help/support.

Therapy helped me get through some tough times, so if therapy is an accessible resource, please consider it.  

Best of luck and much love!!! <3