As a married woman who had an emotional affair with a single guy, I wish I had ended the friendship sooner than I did...the longer it went on, the more painful it became to finally end it and the more damage it did to my life and psyche. 

One thing that helped was acknowledging that the friendship was unhealthy and that nothing good could come from continuing something unhealthy no matter what my feelings were for him. Unhealthiness is never a good foundation! It was a wake up call that I really needed to address some issues so I could be a healthier person and have healthier relationships.

I know I can never be friends with him again, even though I'm healthier now, because 1) his attempts to contact me show that he is still unhealthy, 2) the relationship really hurt my husband and almost ended our marriage, so it would be a really bad idea to be in contact again, and, 3) I could see myself falling back into old patterns.

Hope this helps!