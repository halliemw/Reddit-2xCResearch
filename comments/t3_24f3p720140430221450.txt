He finally stood up for himself against your shitty behaviour. Can you blame him for moving on after this?
At this point all you can do is try to make some new friends, and this time treat them with respect and don't take them for granted!