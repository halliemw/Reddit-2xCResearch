I had the same situation with my old boss.  She was completely insane, going through menopause and was just intentionally seeking ways to hurt my feelings and affect my job.  I had enough of it and had given her a two month notice because I had planned to leave the state for a different job.  This would give her time to find a replacement and she would get her wish for me to just leave.  

Boy, did that backfire.  She tried for two months every hour of the working day to find a reason to fire me.  Making me do the most insane tasks and constantly commenting about my poor attitude. I was crying everyday and had to see a therapist who recommended I file a workman's comp claim for the abuse/harassment.  

I finally went into her boss's office and spoke about the situation and he had me moved to a different department to carry out the rest of my remaining weeks.  I think he realized just how insane she had gotten over the situation and promised me a reference letter to take with me because he knew she would never give me anything in the future for a reference.  
She had done nothing to replace me just sat there all day making my life hell.  I still think about that woman and just how nucking futs she was and it definitely left a life long impact on how I view working with women in general.   