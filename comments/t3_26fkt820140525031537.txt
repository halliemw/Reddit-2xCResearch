It's important to be firm and exceedingly clear, but definitely harder during work at retail when you're expected to be nice to customers! I'm so sorry you had to put up with that awful man; his behaviour was disgusting.

Depending on what they're saying you could try either deflecting them if you're at work (ex. Is there anything I can help you find? I'm sorry, I can only help with store-related queries & walking away - or something?), but if you're not at work you can be harsher. 

There is nothing wrong with responding to someone being entirely inappropriate and pushing boundaries by being more blunt, even meaner - sometimes it's necessary. You could try just being straightforward and and as clear as possible (i.e. I am not interested. No means no, it does not mean keep pushing. Goodbye). 

[This guide](http://www.ihollaback.org/resources/responding-to-harassers/) is more focused on street harassment, but it has some good general tips like be firm, don't engage & keep moving (where possible).