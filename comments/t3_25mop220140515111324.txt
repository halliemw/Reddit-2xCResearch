I, like other people here think that he needs to seek help, but it doesn't sound like he is interested in that yet.

One thing to remind him of might be this: all of our mistakes get us to where we are now. He seems like a great guy, and there is no way that he could have become such a great guy if he hadn't taken the path that he has taken. And mistakes are included on that path. If he hadn't messed up at some point, how could he have even learned how to avoid those mistakes, or how to make better choices. Mistakes make you a better person if you learn from them. It seems like he not only has learned from them, but thinks that he should have been able to avoid them in the first place. But you can't know something before you know it. He can't have learned from his mistakes before he made them. 

Not sure if this is helpful at all. But I totally sympathize with both you and your SO. 