First off, any complaints made about the Officers conduct will have to come from your friend. You can provide moral support to your friend, but remember that unless you were present during the questioning or are some way involved (Witness to the crime) you have no standing legal to file a complaint. Since I wasn't there I cant speak to the Officers conduct, but perhaps I can shed some light on the reasoning behind some of the questions. 

Asking if she is sexually active is a valid question, especially if the victim had sex prior to or after the alleged rape. Bodily fluids can mix or in the absence of the rapists fluid the victims boyfriend or partner could be implicated in the crime. Saying "Yes, I did have sex with my boyfriend earlier in the day" will help the police definitively rule him out if his fluids are found. Intoxication is unfortunately a factor and for many reasons the officer has a duty to inquire whether or not your friend was intoxicated at the time of the rape, because believe me if charges are filed the defense is going to not only make an issue of it, they will make an issue as to why the officer didn't ask. It is also a very important question whether or not a victim tried to stop the rape and if so what they did. Just because your friend didn't say anything (Perhaps she was too scared at the time) doesn't mean she wasn't raped, but once again the officer needs to find this information out in order to build a strong case as rape is one of the most difficult charges to prosecute and win. The officer is on the side of the victim and while nothing excuses insensitivity, it's very frustrating to police when victims don't go immediately to the police so that evidence can be preserved and the rapist locked away where he belongs. Please also remember that until someone is convicted the police need to show impartiality by referring to the crime as alleged. Calling someone a murderer or rapist before conviction is just something else the defense can use to show bias against the accused by the policeand possibly win an acquittal. 

If a finding was made that there wasn't enough evidence to prosecute then that decision was most likely made by the prosecuting attorney and not the officer directly, but since I dont know where you live I cant say for sure this is the case. If your friend cannot find justice through the legal system she can always file a civil suit. Civil suits dont have to be proven beyond a reasonable doubt like criminal trials so your friend may find some satisfaction in possibly bankrupting this creep. In any case your friend needs to find a good therapist and keep going no matter what. Rape is violation that lingers emotionally and mentally long after the physical heals and woman who have been raped have a higher incidence of thing like drug/alcohol abuse, depression and even suicide. Good luck to your friend I wish her peace and hopefully some closure after this 