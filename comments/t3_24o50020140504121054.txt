If the suggested comments don't help, you will need to get your SO on board. Have him take the guy aside and explain that his comments are not cool and are making you uncomfortable and he needs to stop, NOW. 

Also just do your best to avoid the guy--in a way that sends a message. When he comes over to you, excuse yourself to the restroom or pretend to take a call. There's no need to be polite to someone so rude--he needs to get the message, and your polite attempts clearly haven't worked so far. 