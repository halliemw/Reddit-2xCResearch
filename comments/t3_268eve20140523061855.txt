It's difficult for me to answer some of those questions, to be honest.  I don't drink or do recreational drugs, so this was my first experience of being out of my mind/not being able to remember something because of drugs.  So I guess I do feel kind of taken advantage of?  But I also don't think that he believed I was in a state of mind where I was able to consent, either because it didn't occur to him that the pills may have impaired my capacity to consent, or because he believed I was coherent enough in my behavior to be able to consent.  I 100% believe this was a mistake or error in judgement.

I was given more sleeping pills while still on antidepressants a few months ago, while with a new SO.  Before taking the pills this time, I informed my SO that the pills may make me behave strangely, and I asked him not to have sex with me that night even if I later asked him to/tried to initiate it.  So I guess I'm just not comfortable having sex when my mind is out of it.