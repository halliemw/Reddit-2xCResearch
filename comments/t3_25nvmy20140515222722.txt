>What does her previous consensual sexual activity have to do with being raped?

Because it affects the physical evidence.

>How does insinuating that she didn't fight hard enough help an investigation?

Op said he "asked why she didn't scream or push him off of her."

Obviously this is to see if there exist any holes in her story. Once again, they don't want to arrest someone as soon as someone claims they were raped. If you weren't aware, arrest records **never** go away.

>Or criticizing the time that she waited?

This is the only thing he probably did wrong. I agree, telling her she should have gone earlier doesn't help much.

>Or suggesting that her drinking invalidates her lack of consent?

Op said he "asked how she knows she hadn't consented if she had been drunk." Obviously a rape accusation isn't as reliable if the alleged victim is so drunk they can't remember what happened. I'm not saying that's what happened to OP's friend, but the officer doesn't know that. That's why he asks questions. Everything he said is standard protocol.