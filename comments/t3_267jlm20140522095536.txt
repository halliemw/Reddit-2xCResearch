unfortunately when someone latches onto something for support( alcohol, compulsion, drugs, stealing, religion) it's hard to distance them from it. I suspect he wasn't getting what he thought he needed from his marriage/life and so sought or found it elsewhere.

If it were me I would have a hard line conversation: this is hurting us, I'm fine with you being "x" but it needs to be dialed down - if that didn't work I would have to consider more drastic steps - time to move on.