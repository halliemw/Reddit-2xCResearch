> Is it legal to carry a knife on you?

Definitely an important thing to consider. Some states will require you to register defensive tools like pepper spray with the police, while others go so far as to require you to possess a firearms permit to be able to purchase and use pepper spray. In the state of MA, if you don't have a permit and use pepper spray on someone, your jail sentence could be longer than that of the person who attacked you.

> what liability could there be if you attacked him to defend yourself?

Issues like this is a major reason that some states require you to take a class before issuing a concealed carry permit for a firearm, and why it's a good idea to take such a class even if one is not legally required for you to obtain a permit. 