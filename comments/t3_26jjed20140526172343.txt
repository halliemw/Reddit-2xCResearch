Whoa that sounds scary! No wonder you're shaken up. OK please definitely look up portable door locks.

Also whilst closing the window would have reduced this guy's opportunity level or whatever, don't for a minute see that as a case of "it's all my fault". We can do our best to protect ourselves against these people, sure, but an "opportunity crime" is still a crime and still another person actively choosing to harm another person. 

And please don't get a gun that can be used against you. But do look into something like pepper spray or mace or whatever is legal where you are, which if used against you is unpleasant but not fatal, and may be instrumental in saving your life (or at the bare minimum, your property).

There are also light things that flicker and make it look like someone is watching TV. These can make people think someone is home and awake.

My dad actually has a whole system of lamps on timers that change in the evening to make it look like someone is moving around the house and stuff, but that's a little over-complicated compared to the TV simulation thing. But my dad works up and down the country, so I guess he worries about his house when he's away.