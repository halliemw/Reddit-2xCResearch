My wife used to take Ambien for along time to help with her sleep, but we never knew what it would actually do. One night she took it and couldn't fall asleep so she took more, but I didn't know it. She continued to stay awake - physically - and wanted to have sex so we did. She was a little weird, but we had just had a complete conversation in the last ten minutes and I just thought that it wasn't working on her and we'd have to find another sleeping medicine. Afterwards, she fell asleep and slept like a log. In the morning when I talked to her about the previous night, she had absolutely no idea what I was talking about. The look of shock on her face was more than enough to make me never again do anything with her when Ambien was involved.  
You should tell him. He may or may not be surprised or hurt, but tell him anyway. It sounds like you need to.