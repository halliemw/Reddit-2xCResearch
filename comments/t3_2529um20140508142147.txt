Becoming physically sick because he rejected you is a pretty clear sign that you were in way too deep emotionally and codependent on him before even meeting him in person. I get it--I landed myself in the hospital after a break up because I was so physically ill from the emotional toll. 

But letting one person, albeit someone who you were emotionally invested in, destroy your self esteem is so completely unfortunate. He reacted like an asshole by sleeping with you when he wasn't interested in you as a person and that alone should tell you what kind of person he is. Don't blame yourself for not seeing his disinterest, love and hormones make us all do crazy things. 

Almost everyone, no matter how conventionally attractive they are, has been rejected for how they look at some point in their lives. I know it hurts to think about and it's completely normal to feel insecure and ego-bruised, but don't let his dickish reaction steal anymore of your time. It's been over a year, yes? You made changes that have made you feel awesome, healthier, and more attractive--that is such an amazing thing that most people never would have taken the steps toward. Keep doing the things that make you more confident and tell yourself every day that you are awesome and beautiful. Change the little negative voice in the back of your head to a positive one and you will start believing it. You deserve better than believing you are repulsive. 