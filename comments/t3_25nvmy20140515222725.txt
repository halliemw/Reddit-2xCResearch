I am someone who was raped (official crime of aggravated rape, as there were multiple people involved), and all of the questions OP listed seem, when looked at objectively, good and fair questions to be asked. The officer had to use the term "alleged" because that's what's appropriate before it's been officially judged. It wasn't disrespectful nor was he discrediting her awful experience. He was adhering to the law. He also must have asked her her sobriety so their can be a clear statement. Knowing her sexual activity was, again, standard and important. 

I'm sorry that things didn't go as we all feel they should have for OPs friend, I truly am, but in this day and age because there are people who DO cry rape, it's that officer's job to ask the tough questions so that he and the people working the case can make the best decision regarding the handling of the crime. We all (you, me, OP, that cop) want rapists off the street. That being said: the friend should go to someone else at the station and try again. The fact remains that he couldn't find anything tangible, but someone else may be able to look at her case in a different light. 

Remember: cops want to catch bad guys. It's what they sign up for. Hell, as I type this, my boyfriend is studying for a law exam he will be taking at the Police Academy next Monday. He sleeps about 4.5 hours a night, gets his ass kicked at the academy all day, then studies all night when he gets home. His whole life is consumed by learning how to protect, and then training in order to do it effectively. Cops know the laws. They know what charges they can make stick, and what can't. Although some of them can be a bit gallows-ish in humor and outlook, every single one of them strap into a vest every work day, get spit on, get shot at, and risk their lives on a daily basis to protect and serve people. Just this morning my local police station buried a 25 year old officer. These people are willing to, and do, die while trying to help. They're not going to brush off a rape victim, it's not in their nature. 

What is happening here is that OPs emotional feelings are geared towards a matter which had very black and white legal rules. The case her friend has doesn't meet the criteria of the rules the cop must follow in order to pursue a case. There is only so much a cop can do when the evidence is gone, it's been a week, sobriety is in question, etc. It sucks a LOT, but they have to adhere to the rules. 