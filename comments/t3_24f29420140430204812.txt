The whole situation is a mess, and you're complicit in it but you didn't cause it. That said, if Troy leaves Molly, there are a number of things that will need to happen. He'll need to divorce her, which isn't going to be cheap especially since he's going to want custody of that kid if the only other home it can grow up in is full of mold and excrement. There's no option for adoption if both parents don't want to forfeit parental rights, and I can't see them doing that for a planned baby. 

For your own sanity, you need to keep your distance until he's made a decision and acted on it. My aunt dated a guy in a similar situation for years and even got engaged to him, but the marriage he was in never officially ended and she wasted years of her life with a man who had never had the guts to deal with life on his own. Not that anyone is ever completely alone, but this guy really sounds like he doesn't have any independence and never has. This is one of those cases where he really needs to get his own life together before you should be getting tangled up in it or making grand gestures like buying him plane tickets. He has options that don't require flying away from his pregnant wife on someone else's dime.