None of this is your fault.  

Both of you are adults.  You have gone out of your way to recognize a "mistake" (i dont consider it one, but if you do, fine by me) and then apologize to her for it and work on building your relationship.  Even doing things that are usually not called for like avoiding your bf when she is around kind of thing.

She sounds like she has some issues.  What has she done for you?? badmouth you?  Why? because she cant stand the thought of you being happy.  There are certain type of people that think that there is a finite amount of happiness in the world and when one person is happy it makes them unhappy because the only way for them to feel good about themselves is to put other people down.

Your friend fits this category.  If you were single, she would invite you to hang out with her bf and her all the time to rub her relationship status in your face.  

Say good riddance to this kind of toxic person.  You are better off without her.  3 years of trying is toooo damn much.