This is not something I can advise you to do, and I certainly understand if you don't, but I would speak up. Providing you do so in a professional manner, your superiors cannot legally deny you a reference or even give you a bad one. Part of the reason this stuff keeps happening is because we're all too scared to say anything. We need to change that. They should be afraid to make their comments.