Pretty much this. The text to him didn't ruin the surprise - going through his wallet did. He just didn't know it was ruined yet.

I don't know, but if I was planning something important like that and wanted it to be a surprise... I think I'd rather know right away if the secret was out instead of finding out the hard way once the big day arrived (or shortly afterwards). That has to be an incredible feeling of disappointment.