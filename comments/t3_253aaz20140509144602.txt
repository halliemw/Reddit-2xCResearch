I feel the issue is quite circular. Since the fields are male dominated, media will depict them this way. The bad part when it comes to these shows and women is that when the geek plays a major role, to highlight their social anxiety, a woman is used. Geeks suck with girls, right? Thus to establish some nice comedic contrast the woman is separate form the topic. Perhaps a particularly slow girl. This unfortunately leads to the juxtaposition of smart awkward men with dumb/average socially apt women.

Hmm, BBT as an example, I think Penny serves as that straightman role for both female and male characters. If I recall correctly there were some other accomplished females in the show, each of whom was quite quirky. I'd say this show makes a for a misrepresentation of people in STEM, in general.