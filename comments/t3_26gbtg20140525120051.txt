> I'm trying to figure out, in my own head, whether I should be angry at myself for caving in (which is weirdish because I cave in because I feel guilty for saying no), or if I'm just overreacting, or what.

Why are the only 2 options have you to blame?  He's a jerk.  Why do you keep hanging out with him?  This is not the behaviour of a friend.  

Coercion is not enthusiastic consent.  It's manipulation and fully disregards the other person.  